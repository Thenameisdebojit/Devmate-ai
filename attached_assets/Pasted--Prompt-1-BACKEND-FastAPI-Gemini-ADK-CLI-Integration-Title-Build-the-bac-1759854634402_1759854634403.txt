---

## ðŸ§© *Prompt 1 â€” BACKEND (FastAPI + Gemini ADK/CLI Integration)*

*Title:*

> ðŸ”§ Build the backend for â€œDevmateâ€ â€” a Gemini-powered AI coding assistant

*Prompt for Replit AI:*

---

You are an expert Python backend engineer.
Build a *FastAPI backend* for *Devmate, a **domain-specific AI coding support agent* powered by *Gemini CLI / ADK*.

---

### ðŸ§  Requirements

*Core functionality:*

* Receive user prompts via REST API
* Generate or explain code using Gemini models (via ADK / CLI)
* Switch between domain contexts (â€œWeb Devâ€, â€œMLâ€, â€œData Scienceâ€, â€œBackendâ€)
* Return structured JSON responses { "output": "...", "type": "code/explanation", "domain": "..." }

*Stack:*

* FastAPI
* Uvicorn
* Gemini ADK & Gemini CLI
  (pip install google-generativeai google-ai-agent-sdk)
* CORS middleware enabled for frontend

---

### âš™ API Endpoints

| Endpoint         | Method | Description                          |
| ---------------- | ------ | ------------------------------------ |
| /generate      | POST   | Generates new code based on prompt   |
| /explain       | POST   | Explains provided code snippet       |
| /switch-domain | POST   | Switches agent domain (sets context) |
| /health        | GET    | Returns â€œOKâ€ if server running       |

---

### ðŸ§© File Structure


backend/
â”œâ”€â”€ main.py
â”œâ”€â”€ agent.py
â”œâ”€â”€ config/
â”‚   â””â”€â”€ agent.yaml
â”œâ”€â”€ logs/
â”‚   â””â”€â”€ gemini.log
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md


---

### ðŸ“œ agent.yaml (store in config/agent.yaml)

yaml
name: devmate
tools:
  - type: code
prompts:
  - role: system
    content: >
      You are Devmate, an AI coding support agent powered by Gemini.
      You specialize in writing, explaining, and optimizing Python, JS, and ML code.


---

### ðŸ’» agent.py

python
import google.generativeai as genai
from google.ai.generativelanguage import AgentsClient

genai.configure(api_key="YOUR_GEMINI_API_KEY")

class DevmateAgent:
    def __init__(self):
        self.client = AgentsClient.create_agent(
            display_name="Devmate",
            instructions="You are a helpful code generation and explanation agent."
        )
        self.domain = "General"

    def set_domain(self, domain: str):
        self.domain = domain

    def generate_code(self, prompt: str):
        model = genai.GenerativeModel("gemini-1.5-pro")
        domain_context = f"[Domain: {self.domain}] Generate code for:\n"
        response = model.generate_content(domain_context + prompt)
        return response.text

    def explain_code(self, code: str):
        model = genai.GenerativeModel("gemini-1.5-pro")
        response = model.generate_content(f"Explain this code step by step:\n{code}")
        return response.text


---

### âš¡ main.py

python
from fastapi import FastAPI, Request
from fastapi.middleware.cors import CORSMiddleware
from agent import DevmateAgent

app = FastAPI()
agent = DevmateAgent()

app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"]
)

@app.get("/health")
async def health_check():
    return {"status": "ok"}

@app.post("/generate")
async def generate(request: Request):
    data = await request.json()
    prompt = data.get("prompt", "")
    result = agent.generate_code(prompt)
    return {"output": result, "type": "code", "domain": agent.domain}

@app.post("/explain")
async def explain(request: Request):
    data = await request.json()
    code = data.get("code", "")
    explanation = agent.explain_code(code)
    return {"output": explanation, "type": "explanation", "domain": agent.domain}

@app.post("/switch-domain")
async def switch_domain(request: Request):
    data = await request.json()
    domain = data.get("domain", "General")
    agent.set_domain(domain)
    return {"message": f"Domain switched to {domain}"}


---

### ðŸ“¦ requirements.txt


fastapi
uvicorn
google-generativeai
google-ai-agent-sdk
python-dotenv


---

### ðŸ§ª Run Instructions

bash
pip install -r requirements.txt
uvicorn main:app --reload


âœ… Test endpoints using Postman or curl before moving to frontend.

---

### âœ… Deliverables

* Fully working backend with endpoints
* Gemini ADK and CLI usage in code
* Domain switching logic
* CORS enabled
* Ready to deploy on Replit or Render

---